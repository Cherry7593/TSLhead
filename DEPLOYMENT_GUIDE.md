# TSLhead插件 - Folia完整适配测试指南

## ✅ 适配完成状态

您的TSLhead插件已经完成了全面的Folia适配优化，所有编译错误和警告都已解决。

### 🔥 主要优化成果

1. **完全Folia兼容** - 智能检测并适配Folia环境
2. **现代化API** - 使用Adventure API替代已弃用的ChatColor
3. **异步优化** - CompletableFuture + 智能调度器
4. **性能提升** - Tab补全只显示在线玩家，避免卡顿
5. **零错误编译** - 所有代码质量问题已修复

## 🚀 部署测试步骤

### 1. 编译插件
```bash
cd /Users/cherry/Desktop/项目/work5/TSL_head
mvn clean package
```

### 2. 验证生成的JAR
检查 `target/TSLhead-1.0.jar` 文件是否生成成功

### 3. 部署到服务器
将JAR文件放到Folia服务器的plugins目录

### 4. 测试命令

#### 基础头颅命令测试
```bash
# 测试获取在线玩家头颅
/tslhead example <在线玩家名>

# 测试获取离线玩家头颅（需要该玩家曾经进入过服务器）
/tslhead memorial <离线玩家名>

# 测试背包满时的掉落机制
/tslhead vip <玩家名> <背包已满的玩家>

# 测试重载配置
/tslhead reload
```

#### CrazyCrates联动测试
```bash
# 测试基础添加到奖池
/tslheadcc memorial <玩家名> example 10.0

# 测试带层级的添加
/tslheadcc vip <玩家名> premium 20.0 rare
```

### 5. 性能验证

#### Tab补全测试
- 输入 `/tslhead ` 然后按Tab - 应该只显示配置的头颅类型和reload
- 输入 `/tslhead example ` 然后按Tab - 应该只显示在线玩家列表
- 确认没有卡顿现象

#### Folia环境验证
在控制台查看启动日志：
```
[TSLhead] TSLhead 已启用
```

## 🎯 功能测试清单

### ✅ 基础功能
- [ ] 获取在线玩家头颅
- [ ] 获取离线玩家头颅（UUID稳定性）
- [ ] 背包满时自动掉落
- [ ] 权限检查
- [ ] 配置重载

### ✅ Folia特性
- [ ] 智能调度器检测
- [ ] 区域安全执行
- [ ] 异步头颅获取
- [ ] 无主线程阻塞

### ✅ CrazyCrates集成
- [ ] 头颅添加到奖池
- [ ] 权重设置
- [ ] 层级支持
- [ ] 错误处理

### ✅ 性能优化
- [ ] Tab补全响应速度
- [ ] 大量离线玩家情况下的稳定性
- [ ] 内存使用情况

## 🔧 故障排除

### 常见问题检查

1. **插件无法启动**
   - 检查Java版本是否为21+
   - 确认Paper API版本兼容性

2. **头颅显示为史蒂夫**
   - 确认玩家曾经进入过服务器
   - 检查网络连接（皮肤服务器）

3. **CrazyCrates命令失败**
   - 确认CrazyCrates插件已安装并启用
   - 检查奖池名称是否正确
   - 验证玩家是否有crazycrates命令权限

4. **Tab补全缓慢**
   - 已优化为只显示在线玩家
   - 如仍有问题，检查服务器整体性能

## 📊 监控指标

### 性能监控
- 插件启动时间
- Tab补全响应时间
- 头颅创建成功率
- 内存使用情况

### 功能监控
- 在线/离线玩家头颅获取成功率
- CrazyCrates集成成功率
- 错误日志频率

## 🎉 部署建议

1. **先在测试服部署** - 确保所有功能正常
2. **逐步开放权限** - 先给管理员测试，再开放给玩家
3. **监控日志** - 关注错误和警告信息
4. **性能观察** - 注意服务器TPS和内存使用

您的TSLhead插件现在已经完全准备好在Folia服务端上部署使用了！
